
<%= render :partial => "/home/navbar" %>


    <!--<div class="container" style="margin-top: 40px">-->
        <div class = "container">
        <ul class="collapsible" data-collapsible="expandable">



            <li>

            <div class="collapsible-header"><i class="material-icons">search</i>검색하기</div>

            <div class="collapsible-body">

                <form action="/home/find" method="POST">

                  <div class="form-group">
                    <div class = "container">
                      <div class = "row" style ="margin:10px">
                        <div class = "col s8 m8 l8">
                          <input type="text" name="find_address" class="form-control" placeholder="키워드를 입력해주세요." style="resize: none; margin:0px" required rows="1" >
                        </div>
                        <div class = "col s4 m4 l4 center">
                          <button class="btn waves-effect waves-light center" type="submit" name="action">검색하기</button>
                        </div>
                      </div>
                    </div>
                  </div>
                </form>
            </div>
            </li>
            <li>
            <div class="collapsible-header"><i class="material-icons">place</i>지도에서 찾기</div>
            <div class="collapsible-body">
                <div id="map" style="width: 100%; height: 400px;"></div>

                <!--지도에서 찍은 값을 데이터베이스에서 검색하는것 구현하기-->
                <form action="/home/find" method="POST">
                    <div class="row">

                        <div class="form-group">
                            <label for="address">주소</label>
                            <div class="col m10">
                            <input type="text" name="find_address" class="form-control" id="findaddress" placeholder="지도에서 클릭해주세요." style="resize: none;" required readonly rows="1" >
                            </div>
                            <div claass="col m2">
                            <button class="btn waves-effect waves-light" type="submit" name="action">Submit
                                    <i class="material-icons right">send</i>
                            </button>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
            </li>
            <li>
            <div class="collapsible-header active"><i class="material-icons">list</i>목록</div>
            <div class="collapsible-body" style = "padding : 20px; overflow:auto;">
                <div class = "row">
                    <% @address.each do |a| %>
                    <div class = "col s12 m6 l3">
                        <div class="card small hoverable">
                            <div class = "card-image">
                                <img src="<%= image_path "intro-bg.jpg" %>">
                                <span class="card-title"><%= a.detail_address %></span>
                            </div>

                            <div class="card-action" style = "height:60px">
                                <div class="row" style = "margin:0px">
                                    <div class = "col s12 m12 l12" style = "padding:0px">
                                        <span><a href="/home/review/<%= a.id %>" style = "margin:0px; ">자세한 내용</a></span><br>
                                    </div>
                                </div>
                                <div class="row" style = "margin:0px">
                                    <div class = "col s12 m12 l12" style = "padding:0px">
                                      <% if a.current_user == current_user.email%>
                                          <a class = "yellow-text text-darken-3" style = "font-size:0.2rem; margin:0px">회원님이 작성한 리뷰</a>
                                          <!--<a href="/update_view_a/<%#= a.id %>" style = "margin:0px; "><i class="material-icons">mode_edit</i></a>-->
                                          <!--<a href="/destroy/<%#= a.id %>" style = "margin:0px"><i class="material-icons">delete</i></a>-->
                                      <% end %>
                                    </div>
                                </div>
                            </div>


                            <!--<div class="card-reveal">-->
                            <!--  <span class="card-title grey-text text-darken-4">Card Title<i class="material-icons right">close</i></span>-->
                            <!--  <p>Here is some more information about this product that is only revealed once clicked on.</p>-->
                            <!--</div>-->
                        </div>
                    </div>
                    <% end %>

                </div>
            </div>
            </li>
        </ul>
        </div>

    <%= render :partial => "/home/footer" %>



    <!--지도 이벤트-->
    <script>
        var mapContainer = document.getElementById('map'), // 지도를 표시할 div
            mapOption = {
                center: new daum.maps.LatLng(36.363626, 127.347757), // 지도의 중심좌표
                level: 2 // 지도의 확대 레벨
            };

        // 지도를 생성합니다
        var map = new daum.maps.Map(mapContainer, mapOption);
        map.relayout();


        var mapTypeControl = new daum.maps.MapTypeControl();

        // 지도에 컨트롤을 추가해야 지도위에 표시됩니다
        // daum.maps.ControlPosition은 컨트롤이 표시될 위치를 정의하는데 TOPRIGHT는 오른쪽 위를 의미합니다
        map.addControl(mapTypeControl, daum.maps.ControlPosition.TOPRIGHT);

        // 지도 확대 축소를 제어할 수 있는  줌 컨트롤을 생성합니다
        var zoomControl = new daum.maps.ZoomControl();
        map.addControl(zoomControl, daum.maps.ControlPosition.RIGHT);

        // 지도를 클릭했을 때 클릭 위치 좌표에 대한 주소정보를 표시하도록 이벤트를 등록합니다

        // 지도를 클릭했을 때 클릭 위치 좌표에 대한 주소정보를 표시하도록 이벤트를 등록합니다
        daum.maps.event.addListener(map, 'click', function (mouseEvent) {
            searchDetailAddrFromCoords(mouseEvent.latLng, function (status, result) {
                if (status === daum.maps.services.Status.OK) {
                    var detailAddr = !!result[0].roadAddress.name
                        ? '<div>도로명주소 : ' + result[0].roadAddress.name + '</div>'
                        : '';
                    detailAddr += '<div>지번 주소 : ' + result[0].jibunAddress.name + '</div>';

                    if (result[0].roadAddress.name == "")
                        var address_of_building = result[0].jibunAddress.name;
                    else
                        var address_of_building = result[0].jibunAddress.name + " (" + result[0].roadAddress.name + ")";

                    document.getElementById('findaddress').innerHTML = address_of_building;

                    var content = '<div class="bAddr">' + detailAddr + '</div>';
                // 마커를 클릭한 위치에 표시합니다
                marker.setPosition(mouseEvent.latLng);
                marker.setMap(map);

                // 인포윈도우에 클릭한 위치에 대한 법정동 상세 주소정보를 표시합니다
                infowindow.setContent(content);
                infowindow.open(map, marker);

                // 클릭한 위도, 경도 정보를 가져옵니다
                var latlng = mouseEvent.latLng;

                var marker1 = latlng.getLat();
                var marker2 = latlng.getLng();

                document.getElementById('marker1').innerHTML = marker1;
                document.getElementById('marker2').innerHTML = marker2;
            }
        });
    });

        function relayout() {
            // 지도를 표시하는 div 크기를 변경한 이후 지도가 정상적으로 표출되지 않을 수도 있습니다
            // 크기를 변경한 이후에는 반드시  map.relayout 함수를 호출해야 합니다
            // window의 resize 이벤트에 의한 크기변경은 map.relayout 함수가 자동으로 호출됩니다
            map.relayout();
        }
//         $('#map').ready(function() {
// 			auto_refresh();
// 		});
    </script>
